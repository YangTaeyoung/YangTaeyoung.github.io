---
title: 了解进程与线程
type: blog
date: 2024-01-04
comments: true
translated: true
---
## 程序
要理解进程，首先需要了解什么是程序。

程序是指定进程步骤或顺序的文档，通常存储在计算机的硬盘中。

## 进程
进程是正在运行的程序，它被加载到内存中，可以获得CPU的分配。

进程由执行程序所需的数据、内存等资源以及线程组成。

![image](/images/computer_science/img.png)

### 进程获取的操作系统资源示例
- **CPU时间**
  - CPU时间指的是进程实际使用CPU的时间，主要分为用户CPU时间和内核CPU时间。
    - **用户CPU时间**: 在用户模式下运行的时间
    - **内核CPU时间**: 在内核模式下运行的时间
      - _内核：操作系统的核心部分，负责连接硬件和应用程序。_
- **内存**
  - **代码区**: 程序代码存储的区域
    - 指的是实际执行的代码。这里的代码不是程序员编写的代码，而是编译器翻译成机器语言的代码。
  - **数据区**: 全局变量存储的区域
    - 全局变量是程序中使用的变量，存储在程序的数据区。
  - **栈区**: 局部变量存储的区域
    - 局部变量是在函数中声明的变量，当函数被调用时创建，函数终止时销毁，存储在栈区。
  - **堆区**: 动态分配变量存储的区域
    由用户自行管理的变量，存储在堆区。
- **文件及I/O设备**
  - 进程在运行中将所需数据加载到内存中，并将执行结果从内存中写入文件或I/O设备。

### 进程间的内存共享
- 进程使用各自独立的内存区域，因此无法直接访问其他进程的内存。
- 因此，进程之间需要使用适当的通信方式。

#### 进程间通信方式
- **管道**
  - 管道用于使一个进程可以接收来自其他进程的数据。管道只能进行单向通信。
- **消息队列**
  - 消息队列可以以消息为单位进行数据的收发，支持双向通信。
- **共享内存**
  - 共享内存是两个进程可以同时访问的内存区域，可能导致同步问题。
- **套接字**
  - 套接字通过网络进行数据的收发，支持双向通信。
- **信号**
  - 通过信号告知进程发生了某个事件，进程收到信号后处理相应事件。
- **文件**
  - 文件用于读取和写入存储在硬盘的数据，支持双向通信。

### 进程状态
进程在运行过程中其状态会发生变化。进程可以拥有以下状态：

- **运行状态**
  - 进程正在占用CPU并执行指令的状态。
- **就绪状态**
  - 进程未使用CPU但准备随时运行的状态，因为其他进程正在使用CPU。
- **等待状态**
  - 进程未使用CPU，等待输入输出等事件的状态。
- **创建状态**
  - 进程已经创建并分配了内存的状态。
- **终止状态**
  - 进程执行结束并释放内存的状态。

## 线程
线程是进程内执行的多个流的单位。线程利用进程分配的资源实际进行工作。

![img.png](/images/computer_science/process.png)

### 线程的特点
- 相比于进程，线程只各自分配栈区，而共享代码区、数据区和堆区。
- 每个线程拥有独立的程序计数器（PC）和堆栈指针（SP）。
- 每个线程拥有独立的寄存器集合。

### 线程的优点
- 系统资源消耗减少。
  - 线程共享进程内的资源，因此减少了创建进程并分配资源的系统调用。
- 线程间通信简单。
  - 线程共享进程内的资源，因此通信简单。
- 线程的上下文切换速度快。
  - 线程只需各自分配栈区，代码区、数据区和堆区共享，因此上下文切换速度快。
- 线程的创建速度快。
  - 线程共享进程内的资源，因此创建线程比创建进程快。
- 线程的销毁速度快。
  - 线程共享进程内的资源，因此销毁线程比销毁进程快。
- 线程的同步简单。
  - 线程共享进程内的资源，因此同步简单。

## 结语
- 面试时，由于没能及时想起这些内容而无法顺利回答，留下了遗憾的文章。
- _下次不要再犯错了_